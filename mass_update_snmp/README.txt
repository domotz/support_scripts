# Mass Update SNMP Authentication - Domotz

## Overview
This set of PowerShell scripts allows Domotz users to:
1. **Retrieve a list of devices** from their Domotz account using `Device-List-Script.ps1`.
2. **Modify SNMP authentication settings** by updating `device-snmp-updated.csv`.
3. **Apply SNMP changes in bulk** using `Update-SNMP-Auth.ps1`.

---

## Prerequisites
- Windows with PowerShell installed.
- A valid **Domotz API key**.
- The `Device-List-Script.ps1` script to extract device details.
- The `device-snmp-updated.csv` file properly formatted.
- The `Update-SNMP-Auth.ps1` script to apply SNMP changes.

---

## Step 1: Retrieve Device List
Run the following PowerShell script to generate a list of devices:
.\Device-List-Script.ps1

## Step 2: Prepare device-snmp-updated.csv
1. Open the CSV file generated by Device-List-Script.ps1.
2. Copy relevant rows into device-snmp-updated.csv.
3. Modify the SNMP settings as needed.

Required Fields:
SNMP v1 / v2
- SNMP Read
- SNMP Write
- Ignore: Username, Authentication Key, Authentication Protocol, Encryption Key, Encryption Protocol

SNMP v3
- Username
- Authentication Key
- Authentication Protocol
- Encryption Key
- Encryption Protocol
- Ignore: SNMP Read, SNMP Write

Ensure that the "Version (V1, V2, V3)" column is correctly filled (V1, V2, or V3).

## Step 3: Apply SNMP Changes
Run the following script to update the SNMP settings:
.\Update-SNMP-Auth.ps1

The script will:
- Read device-snmp-updated.csv.
- Validate the SNMP settings for each device.
- Prompt for missing values (if any).
- Make API calls to update SNMP settings in Domotz.
- Log all changes in snmp_update_log.txt.

Troubleshooting
1. Script Exits Immediately
	Ensure you have the correct PowerShell execution policy: Set-ExecutionPolicy Unrestricted -Scope Process
	Run the script again.
2. API Key Errors
	Ensure Update-SNMP-Auth.ps1 contains a valid Domotz API key.
3. Missing SNMP Version Errors
	Ensure "Version (V1, V2, V3)" is filled out correctly.
4. Log File Review
	Check snmp_update_log.txt for details on errors and successful updates.

Summary
- Use Device-List-Script.ps1 to export device details.
- Edit device-snmp-updated.csv with SNMP changes.
- Run Update-SNMP-Auth.ps1 to apply changes in bulk.
- Review snmp_update_log.txt for results.

For support, provide the log file to Bobby Wilson (bobby@domotz.com).



